<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Thornton Water Pipeline â€“ Route Alternatives</title>

  <!-- Leaflet CSS -->
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />

  <style>
    body { margin: 0; }
    #map { height: 100vh; width: 100%; }

    /* Legend styling */
    #legend {
      position: absolute;
      bottom: 20px;
      left: 20px;
      background: white;
      padding: 10px 12px;
      font-size: 14px;
      border-radius: 4px;
      box-shadow: 0 0 5px rgba(0,0,0,0.3);
      z-index: 1000;
    }
    #legend span {
      display: inline-block;
      width: 20px;
      height: 4px;
      margin-right: 6px;
      vertical-align: middle;
    }
  </style>
</head>

<body>

  <div id="map"></div>

  <!-- Legend -->
  <div id="legend">
    <b>Route Alternatives</b><br><br>
    <span style="background:red;"></span> Balanced Route<br>
    <span style="background:green;"></span> Environmental Route<br>
    <span style="background:blue;"></span> Parcel Use Route
  </div>

  <!-- Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <script>
    /* -------------------------
       Map initialization
    -------------------------- */
    const map = L.map('map');
    map.setView([40.0, -104.8], 8); // initial safe view

    L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; OpenStreetMap & CARTO'
    }).addTo(map);

    /* -------------------------
       Styles
    -------------------------- */
    const styles = {
      base:    { color: 'red',   weight: 5 },
      nlcd:    { color: 'green', weight: 5 },
      parcels: { color: 'blue',  weight: 5 }
    };

    const startStyle = {
      radius: 8,
      fillColor: "green",
      color: "black",
      weight: 1,
      fillOpacity: 1
    };

    const endStyle = {
      radius: 8,
      fillColor: "black",
      color: "black",
      weight: 1,
      fillOpacity: 1
    };

    /* -------------------------
       Load GeoJSON
    -------------------------- */
    Promise.all([
      fetch('base_route_wgs.geojson').then(r => r.json()),
      fetch('route_nlcd_wgs.geojson').then(r => r.json()),
      fetch('route_parcels_wgs.geojson').then(r => r.json()),
      fetch('start.geojson').then(r => r.json()),
      fetch('water_treatment_plant.geojson').then(r => r.json())
    ])
    .then(([base, nlcd, parcels, startPt, endPt]) => {

      const baseLayer = L.geoJSON(base, {
        style: styles.base
      }).addTo(map);

      const nlcdLayer = L.geoJSON(nlcd, {
        style: styles.nlcd
      }).addTo(map);

      const parcelsLayer = L.geoJSON(parcels, {
        style: styles.parcels
      }).addTo(map);

      const startLayer = L.geoJSON(startPt, {
        pointToLayer: (feature, latlng) =>
          L.circleMarker(latlng, startStyle)
      }).addTo(map);

      const endLayer = L.geoJSON(endPt, {
        pointToLayer: (feature, latlng) =>
          L.circleMarker(latlng, endStyle)
      }).addTo(map);

      /* -------------------------
         Layer controls
      -------------------------- */
      L.control.layers(null, {
        "Balanced Route": baseLayer,
        "Environmental Route": nlcdLayer,
        "Parcel Use Route": parcelsLayer,
        "Source Reservoir": startLayer,
        "Water Treatment Plant": endLayer
      }, { collapsed: false }).addTo(map);

      /* -------------------------
         Fit to all data
      -------------------------- */
      const allLayers = L.featureGroup([
        baseLayer, nlcdLayer, parcelsLayer, startLayer, endLayer
      ]);
      map.fitBounds(allLayers.getBounds());

    })
    .catch(err => {
      console.error("GeoJSON load failed:", err);
      alert("One or more GeoJSON files failed to load. Check console.");
    });
  </script>

</body>
</html>





